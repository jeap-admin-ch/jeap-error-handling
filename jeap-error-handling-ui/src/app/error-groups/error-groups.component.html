<ob-column-layout [left]="true" [right]="false">

	<ng-container column-left-content>
		<app-error-group-filter (searchClicked)="onSearch($event)"></app-error-group-filter>
	</ng-container>

	<ng-container column-main-content>
		<div style="position: relative; min-height: 200px;">
			<mat-progress-bar *ngIf="isLoading" mode="query"></mat-progress-bar>
			<table [dataSource]="dataSource" class="ob-table table-sm" mat-table matSort (matSortChange)="announceSortChange($event)">
				<caption>{{ "i18n.errorGroup" | translate }}</caption>

				<!-- Error Count -->
				<ng-container matColumnDef="anzahl">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="errorCount">{{ 'i18n.error.errorCount' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.errorCount }}</td>
				</ng-container>

				<!-- MessageType-->
				<ng-container matColumnDef="messageType">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="errorEvent">{{ 'i18n.errorhandling.form.messagetype' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.errorEvent }}</td>
				</ng-container>

				<!-- Error Publisher -->
				<ng-container matColumnDef="quelle">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="errorPublisher">{{ 'i18n.error.publisher' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.errorPublisher }}</td>
				</ng-container>

				<!-- Error Code -->
				<ng-container matColumnDef="fehlerCode">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="errorCode">{{ 'i18n.error.errorcode' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.errorCode }}</td>
				</ng-container>

				<!-- Stack Trace Hash -->
				<ng-container matColumnDef="stackTraceHash">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="stackTraceHash">Stack Trace Hash
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.stackTraceHash }}</td>
				</ng-container>

				<!-- First Occurrence -->
				<ng-container matColumnDef="erstAuftreten">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="firstErrorAt">{{ 'i18n.error.createdAt' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.firstErrorAt }}</td>
				</ng-container>

				<!-- Latest Occurrence -->
				<ng-container matColumnDef="letztesAuftreten">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="latestErrorAt">{{ 'i18n.error.modifiedAt' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.latestErrorAt }}</td>
				</ng-container>

				<!-- Ticket Code -->
				<ng-container matColumnDef="jira">
					<th *matHeaderCellDef
						mat-header-cell mat-sort-header="ticketNumber">{{ 'i18n.jiraTicket' | translate }}
					</th>
					<td *matCellDef="let row" mat-cell>{{ row.ticketNumber }}</td>
				</ng-container>

				<ng-container matColumnDef="errorDetails">
					<th *matHeaderCellDef id="actions-column" mat-header-cell>
					</th>
					<td *matCellDef="let row" id="actions-row" mat-cell>
						<div class="actions-wrapper">
							<a mat-icon-button obButton="secondary"
							   [routerLink]="['/error-group-details', row.errorGroupId]"
							   [matTooltip]="'i18n.errorhandling.details' | translate">
								<mat-icon svgIcon="eye"></mat-icon>
							</a>
						</div>
					</td>
				</ng-container>

				<tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
				<tr *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
			</table>
		</div>
		<div class="paginator-container">
			<mat-paginator (page)="announcePaginatorChange()"
						   [length]="resultsLength"
						   [pageSizeOptions]="[5,10,20,50,100]"
						   [pageSize]="20"/>
		</div>
	</ng-container>
</ob-column-layout>
